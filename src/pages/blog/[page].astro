---
import { type CollectionEntry, getCollection } from "astro:content";

import BlogPost from "@/components/BlogPost.astro";
import BaseLayout from "@/layout/BaseLayout.astro";
import Pagination from "@/components/Pagination.astro";

export async function getStaticPaths({ paginate }) {
  const res = await getCollection("blog");

  // 根据宇航员数组生成页面，每页2项
  return paginate(res, { pageSize: 7 });
}
// 所有分页数据都在 "page" 参数中传递

type Props = {
  page: Page;
};

type Page = {
  data: CollectionEntry<"blog">[];
  lastPage: String;
  currentPage: String;
};

const { page } = Astro.props;
---

<BaseLayout>
  {
    page.data.map((post) => {
      console.log(post);
      return <BlogPost {...post.data} />;
    })
  }
  <Pagination pageCount={page.lastPage} current={page.currentPage} />
</BaseLayout>
